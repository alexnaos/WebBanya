from machine import Pin, I2C                         # Импортируем необходимые модули для работы с пинами и I2C
import ssd1306                                       # Импортируем библиотеку для работы с OLED-дисплеем
import time                                          # Импортируем модуль для работы с временем
import math                                          # Импортируем модуль для математических операций

i2c = I2C(0, scl=Pin(22), sda=Pin(21), freq=400000)  # Инициализация I2C с заданными пинами и частотой
oled = ssd1306.SSD1306_I2C(128, 64, i2c)             # Инициализация OLED-дисплея с разрешением 128x64

def krug (x0, y0, radius, color):             # Функция для рисования круга
    
    for x in range(-radius, radius + 1):      # Проходим по всем x-координатам в диапазоне радиуса
        y = int(math.sqrt(radius**2 - x**2))  # Вычисляем y-координату по формуле окружности
        oled.pixel(x0 + x, y0 + y, color)     # Рисуем верхнюю часть круга
        oled.pixel(x0 + x, y0 - y, color)     # Рисуем нижнюю часть круга

def face():                                   # Функция для рисования лица
    
    oled.fill(0)                              # Очищаем экран
    krug(64, 32, 20, 1)                       # Рисуем круг (лицо)x, y, радиус, цвет
    krug(56, 28, 4, 1)                        # Рисуем левый глаз
    krug(72, 28, 4, 1)                        # Рисуем правый глаз

def blink_optic():                            # Функция для моргания глаз
    
    for _ in range(5):                        # Моргаем 5 раз
        oled.fill(0)                          # Очистка экрана
        face()                                # Рисуем лицо
        krug(56, 28, 4, 0)                    # Закрываем левый глаз
        krug(72, 28, 4, 0)                    # Закрываем правый глаз
        oled.show()                           # Обновляем экран
        time.sleep(0.2)                       # Задержка

        oled.fill(0)                          # Очистка экрана
        face()                                # Рисуем лицо
        krug(56, 28, 4, 1)                    # Открываем левый глаз
        krug(72, 28, 4, 1)                    # Открываем правый глаз
        oled.show()                           # Обновляем экран
        time.sleep(0.2)                       # Задержка

def scrolling_text(text, delay=0.001):        # Функция для прокрутки текста по экрану
    
    text_length = len(text) * 8               # Длина текста в пикселях (8 пикселей на символ)
    for x in range(128 + text_length):        # Сдвиг текста за пределы экрана
        oled.fill(0)                          # Очистка экрана
        oled.text(text, 128 - x, 0)           # Рисуем текст на экране
        oled.show()                           # Обновляем экран
        time.sleep(delay)                     # Задержка между кадрами

while True:                                   # Оснвной цикл
    face()                                    # Функция для рисования лица
    blink_optic()                             # Функция для моргания глаз
    scrolling_text("autoielec.ru")            # Бегущая строка
